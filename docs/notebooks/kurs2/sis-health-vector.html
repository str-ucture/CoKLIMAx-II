

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SIS Health Vector &mdash; Coklimax 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Temperature Statistics for Europe" href="sis-temperature-statistics.html" />
    <link rel="prev" title="Satellite Lake Water Temperature" href="satellite-lake-water-temperature.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Coklimax
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Erste Schritte:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/einf%C3%BChrung_cds.html">Der Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/einf%C3%BChrung_jupyter_notebooks.html">Einführung in die CoKLIMAx II Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/einf%C3%BChrung_kurz_elemente.html">Einführung Kurz Elemente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/notwendige_software_und_kenntnisse.html">Required Software and Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_verification.html">Setup Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/introduction_cds.html">The Copernicus Climate Data Store (CDS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs1/herunterladen_ersten_datensatzes.html">Download Your First Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kurs1/analysis_and_visualization.html">Use Case: Analysis and Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 2:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="satellite-lake-water-level.html">Satellite Lake Water Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="satellite-lake-water-temperature.html">Satellite Lake Water Temperature</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SIS Health Vector</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api-authentication">2.1 API Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-processing-and-visualization">3. Data Processing and Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#recording-of-available-rcp-scenarios-and-statistics">3.1 Recording of available RCP scenarios and statistics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sis-temperature-statistics.html">Temperature Statistics for Europe</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 3:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs3/senthub_downloader.html">SentinelHub Downloader</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coklimax</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SIS Health Vector</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/kurs2/sis-health-vector.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sis-health-vector">
<h1>SIS Health Vector<a class="headerlink" href="#sis-health-vector" title="Link to this heading"></a></h1>
<p>Eignung für das Vorkommen und die saisonale Aktivität der Tigermücke (Aedes albopictus) in Europa</p>
<p>Dieses Skript verarbeitet den Datensatz <strong>SIS Health Vector</strong> aus dem Copernics Climate Data Store. Der Datensatz enthält Informationen zu der Eignung der Umweltbedingungen sowie der saisonalen Aktivität der Tigermücke. Der Datensatz wurde im Rahmen des C3S European Health Service entwickelt. Die Informationen sind für unterschiedliche zukünftige Zeiträume und Klimawandelszenarien verfügbar.</p>
<p><strong>Informationen zum Datensatz</strong>:</p>
<ul class="simple">
<li><p>Source: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/sis-health-vector?tab=overview">SIS Health Vector</a></p></li>
<li><p>Author: T. Tewes (Stadt Konstanz)</p></li>
<li><p>Notebook-Version: 1.1 (Updated: December 02, 2024)</p></li>
</ul>
<section id="specifying-the-paths-and-working-directories">
<h2>1. Specifying the paths and working directories<a class="headerlink" href="#specifying-the-paths-and-working-directories" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="sd">&#39;&#39;&#39; ---- Hier die Verzeichnisse angeben ---- &#39;&#39;&#39;</span>
<span class="n">download_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-health-vector\download&quot;</span>
<span class="n">working_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-health-vector\working&quot;</span>
<span class="n">geotiff_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-health-vector\geotiff&quot;</span>
<span class="n">csv_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-health-vector\csv&quot;</span>
<span class="n">output_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-health-vector\output&quot;</span>
<span class="sd">&#39;&#39;&#39; ----- Ende der Eingaben ---- &#39;&#39;&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">working_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">geotiff_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">csv_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-and-extract-dataset">
<h2>2. Download and Extract Dataset<a class="headerlink" href="#download-and-extract-dataset" title="Link to this heading"></a></h2>
<section id="api-authentication">
<h3>2.1 API Authentication<a class="headerlink" href="#api-authentication" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;fdae60fd-35d4-436f-825c-c63fedab94a4&quot;</span>
    <span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;https://cds.climate.copernicus.eu/api&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">api_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">api_key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="request-definition-and-download">
<h3>2.2 Request Definition and Download<a class="headerlink" href="#request-definition-and-download" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define additional request fields to ensure the request stays within the file size limit.</span>
<span class="c1"># These coordinates were obtained using the BBox Extractor tool: https://str-ucture.github.io/bbox-extractor/</span>

<span class="n">bbox_wgs84_deutschland</span> <span class="o">=</span> <span class="p">[</span><span class="mf">56.0</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">,</span> <span class="mf">47.2</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span>
<span class="n">bbox_wgs84_konstanz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">47.9</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">47.6</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;sis-health-vector&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;suitability&quot;</span><span class="p">,</span>
        <span class="s2">&quot;season_length&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;rcp4_5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rcp8_5&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;ensemble_statistic&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;ensemble_members_average&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ensemble_members_standard_deviation&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">bbox_wgs84_deutschland</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment and run this cell to download the dataset:</span>

<span class="k">def</span> <span class="nf">main_retrieve</span><span class="p">():</span>
    <span class="n">dataset_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">.zip&quot;</span>
    <span class="n">dataset_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">dataset_filename</span><span class="p">)</span>

    <span class="c1"># Download the dataset only if the dataset has not been downloaded before</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dataset_filepath</span><span class="p">):</span>
        <span class="c1"># Download the dataset with the defined request parameters</span>
        <span class="n">client</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">dataset_filepath</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataset already downloaded.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">main</span><span class="p">()</span>
    <span class="n">main_retrieve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-09 14:01:27,184 INFO [2024-09-28T00:00:00] **Welcome to the New Climate Data Store (CDS)!** This new system is in its early days of full operations and still undergoing enhancements and fine tuning. Some disruptions are to be expected. Your 
[feedback](https://jira.ecmwf.int/plugins/servlet/desk/portal/1/create/202) is key to improve the user experience on the new CDS for the benefit of everyone. Thank you.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-09 14:01:27,186 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-09 14:01:27,187 INFO [2024-09-16T00:00:00] Remember that you need to have an ECMWF account to use the new CDS. **Your old CDS credentials will not work in new CDS!**
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-12-09 14:01:27,188 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already downloaded.
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-the-zip-folder">
<h3>2.3 Extract the Zip folder<a class="headerlink" href="#extract-the-zip-folder" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>

<span class="n">dataset_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">.zip&quot;</span>
<span class="n">dataset_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">dataset_filename</span><span class="p">)</span>
<span class="n">extract_folder</span> <span class="o">=</span> <span class="n">working_folder</span>

<span class="c1"># Extract the zip file</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">dataset_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully extracted files to: </span><span class="si">{</span><span class="n">extract_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Folder is not empty. Skipping extraction.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: The file </span><span class="si">{</span><span class="n">dataset_filepath</span><span class="si">}</span><span class="s2"> was not found.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: The file </span><span class="si">{</span><span class="n">dataset_filepath</span><span class="si">}</span><span class="s2"> is not a valid zip file.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Folder is not empty. Skipping extraction.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-processing-and-visualization">
<h2>3. Data Processing and Visualization<a class="headerlink" href="#data-processing-and-visualization" title="Link to this heading"></a></h2>
<section id="recording-of-available-rcp-scenarios-and-statistics">
<h3>3.1 Recording of available RCP scenarios and statistics<a class="headerlink" href="#recording-of-available-rcp-scenarios-and-statistics" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">def</span> <span class="nf">meta</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;mosquito_(suit|seas)_(rcp\d</span><span class="si">{2}</span><span class="s1">)_(\w+)_v(\d+\.\d+)\.&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="c1"># For subset area</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the given filename does not fit the expected naming scheme&quot;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">,</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">rcp</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">statistic</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">nc_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">meta</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">working_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.nc&#39;</span><span class="p">)]</span>

<span class="n">df_nc_files</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">nc_files</span><span class="p">)</span>
<span class="n">df_nc_files</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>path</th>
      <th>variable</th>
      <th>rcp</th>
      <th>statistic</th>
      <th>version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mosquito_seas_rcp45_mean_v1.0.area-subset.56.0...</td>
      <td>.\data\sis-health-vector\working\mosquito_seas...</td>
      <td>seas</td>
      <td>rcp45</td>
      <td>mean</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mosquito_seas_rcp45_stdev_v1.0.area-subset.56....</td>
      <td>.\data\sis-health-vector\working\mosquito_seas...</td>
      <td>seas</td>
      <td>rcp45</td>
      <td>stdev</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>mosquito_seas_rcp85_mean_v1.0.area-subset.56.0...</td>
      <td>.\data\sis-health-vector\working\mosquito_seas...</td>
      <td>seas</td>
      <td>rcp85</td>
      <td>mean</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>mosquito_seas_rcp85_stdev_v1.0.area-subset.56....</td>
      <td>.\data\sis-health-vector\working\mosquito_seas...</td>
      <td>seas</td>
      <td>rcp85</td>
      <td>stdev</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mosquito_suit_rcp45_mean_v1.0.area-subset.56.0...</td>
      <td>.\data\sis-health-vector\working\mosquito_suit...</td>
      <td>suit</td>
      <td>rcp45</td>
      <td>mean</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>mosquito_suit_rcp45_stdev_v1.0.area-subset.56....</td>
      <td>.\data\sis-health-vector\working\mosquito_suit...</td>
      <td>suit</td>
      <td>rcp45</td>
      <td>stdev</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>mosquito_suit_rcp85_mean_v1.0.area-subset.56.0...</td>
      <td>.\data\sis-health-vector\working\mosquito_suit...</td>
      <td>suit</td>
      <td>rcp85</td>
      <td>mean</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>mosquito_suit_rcp85_stdev_v1.0.area-subset.56....</td>
      <td>.\data\sis-health-vector\working\mosquito_suit...</td>
      <td>suit</td>
      <td>rcp85</td>
      <td>stdev</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import os</span>
<span class="c1"># import pandas as pd</span>
<span class="c1"># from netCDF4 import Dataset, num2date</span>
<span class="c1"># from tqdm import tqdm</span>

<span class="c1"># def netcdf_to_dataframe(nc_file):</span>
    
<span class="c1">#     dataset = Dataset(nc_file[&#39;path&#39;], &#39;r&#39;)</span>
<span class="c1">#     variable = nc_file[&#39;variable&#39;]</span>

<span class="c1">#     if variable == &#39;suit&#39;:</span>
<span class="c1">#         variable_name = &#39;suitability&#39;</span>
<span class="c1">#     elif variable == &#39;seas&#39;:</span>
<span class="c1">#         variable_name = &#39;season_length&#39;</span>
<span class="c1">#     else:</span>
<span class="c1">#         raise ValueError(f&quot;Unexpected variable: {variable}&quot;)</span>
    
<span class="c1">#     if variable_name in dataset.variables and &#39;time&#39; in dataset.variables:</span>
<span class="c1">#         temperature = dataset.variables[variable_name][:]</span>
<span class="c1">#         time = dataset.variables[&#39;time&#39;][:]</span>
<span class="c1">#         lat = dataset.variables[&#39;lat&#39;][:]</span>
<span class="c1">#         lon = dataset.variables[&#39;lon&#39;][:]</span>
        
<span class="c1">#         time_units = dataset.variables[&#39;time&#39;].units</span>
<span class="c1">#         time_calendar = dataset.variables[&#39;time&#39;].calendar if hasattr(dataset.variables[&#39;time&#39;], &#39;calendar&#39;) else &#39;standard&#39;</span>
<span class="c1">#         time = num2date(time, units=time_units, calendar=time_calendar)</span>
        
<span class="c1">#         variable_column_name = f&quot;{variable}-{nc_file[&#39;rcp&#39;]}-{nc_file[&#39;statistic&#39;]}&quot;</span>
        
<span class="c1">#         rows = []</span>
<span class="c1">#         for t in range(temperature.shape[0]):</span>
<span class="c1">#             for i in range(temperature.shape[1]):</span>
<span class="c1">#                 for j in range(temperature.shape[2]):</span>
<span class="c1">#                     rows.append({</span>
<span class="c1">#                         &#39;time&#39;: time[t],</span>
<span class="c1">#                         &#39;latitude&#39;: lat[i],</span>
<span class="c1">#                         &#39;longitude&#39;: lon[j],</span>
<span class="c1">#                         variable_column_name: temperature[t, i, j]</span>
<span class="c1">#                     })</span>
        
<span class="c1">#         df = pd.DataFrame(rows)</span>
<span class="c1">#         df[&#39;time&#39;] = pd.to_datetime(df[&#39;time&#39;].map(str))</span>
<span class="c1">#         df[&#39;latitude&#39;] = pd.to_numeric(df[&#39;latitude&#39;])</span>
<span class="c1">#         df[&#39;longitude&#39;] = pd.to_numeric(df[&#39;longitude&#39;])</span>
<span class="c1">#         # df[variable_column_name] = pd.to_numeric(df[variable_column_name])</span>
        
<span class="c1">#         # Setze den Index auf time, latitude und longitude</span>
<span class="c1">#         return df.set_index([&#39;time&#39;, &#39;latitude&#39;, &#39;longitude&#39;])</span>

<span class="c1">#     else:</span>
<span class="c1">#         # Zugriff auf das nc_file Dictionary separat aufgelöst</span>
<span class="c1">#         path = nc_file[&#39;path&#39;]</span>
<span class="c1">#         raise ValueError(f&quot;Variables not found in {path}&quot;)</span>

<span class="c1"># dataframes = [netcdf_to_dataframe(nc_file) for nc_file in tqdm(nc_files)]</span>

<span class="c1"># # Kombiniere alle Daten in eine Tabelle</span>
<span class="c1"># df = pd.concat(dataframes, axis=1)</span>
<span class="c1"># df</span>

<span class="c1"># ## Export and compile takes more than 30s, error in sphinx</span>
<span class="c1"># ## Runs without error locally</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># csv_path = os.path.join(csv_folder, &#39;sis-health-vector.csv.zip&#39;)</span>


<span class="c1"># if not os.path.isfile(csv_path):</span>
<span class="c1">#     df.to_csv(csv_path, sep=&#39;,&#39;, encoding=&#39;utf8&#39;, compression=&#39;zip&#39;)</span>
<span class="c1">#     print(f&quot;Summary data exported to {csv_path}&quot;)</span>
<span class="c1"># else:</span>
<span class="c1">#     print(f&quot;{csv_path} file already exists. Skipping export.&quot;)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="satellite-lake-water-temperature.html" class="btn btn-neutral float-left" title="Satellite Lake Water Temperature" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sis-temperature-statistics.html" class="btn btn-neutral float-right" title="Temperature Statistics for Europe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, str.ucture GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>