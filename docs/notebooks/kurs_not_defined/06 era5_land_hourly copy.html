

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ERA5-Land Hourly Data &mdash; Coklimax 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=a1fa38c2" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="application/vnd.jupyter.widget-state+json">{"state": {"f7740919414c4e0887b0a5236f7a19aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "50%"}}, "522ea52bcbc34e43baa706849b815aef": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": "initial"}}, "0afffb54bfee4702a12a5ca0346e86c4": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["var_group_temperature", "var_group_lake", "var_group_soil_water", "var_group_radiation_and_heat", "var_group_evaporation_and_runoff", "var_group_wind_pressure_and_precipitation", "var_group_vegetation"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Select a variable group", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_f7740919414c4e0887b0a5236f7a19aa", "style": "IPY_MODEL_522ea52bcbc34e43baa706849b815aef", "tabbable": null, "tooltip": null}}, "a31f4b90ef3544e78cfed030a0a952e7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "50%"}}, "1719738865b84ec38774a157d7f1802f": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": "initial"}}, "9eb11b4e269540e69d9a56d053f96cc5": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["2m_dewpoint_temperature", "2m_temperature", "skin_temperature", "soil_temperature_level_1", "soil_temperature_level_2", "soil_temperature_level_3", "soil_temperature_level_4"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Select the variable of interest", "description_allow_html": false, "disabled": false, "index": 1, "layout": "IPY_MODEL_a31f4b90ef3544e78cfed030a0a952e7", "style": "IPY_MODEL_1719738865b84ec38774a157d7f1802f", "tabbable": null, "tooltip": null}}, "e8692d3996744c53be1c5b2c42fff0b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "50%"}}, "ebfc411b12594336b6a6cc0abf91c2fb": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": "initial"}}, "82a06b31cf6146738acf388bd7affec7": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["1950", "1951", "1952", "1953", "1954", "1955", "1956", "1957", "1958", "1959", "1960", "1961", "1962", "1963", "1964", "1965", "1966", "1967", "1968", "1969", "1970", "1971", "1972", "1973", "1974", "1975", "1976", "1977", "1978", "1979", "1980", "1981", "1982", "1983", "1984", "1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022", "2023", "2024"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Select the year for downloading data:", "description_allow_html": false, "disabled": false, "index": 74, "layout": "IPY_MODEL_e8692d3996744c53be1c5b2c42fff0b5", "style": "IPY_MODEL_ebfc411b12594336b6a6cc0abf91c2fb", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
      <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Coklimax
              <img src="../../_static/coklimax_logo_new.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">INHALTE:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/notwendige_software_und_kenntnisse.html">Required Software and Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/der_kurz_elemente.html">Die Kurz Elemente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/der_cds.html">Der Copernicus Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_intro/der_jupyter.html">Jupyter Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs1/herunterladen_ersten_datensatzes.html">Download Your First Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kurs1/analysis_and_visualization.html">Use Case: Analysis and Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs2/01%20satellite-lake-water-level.html">Satellite Lake Water Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kurs2/02%20satellite-lake-water-temperature.html">Satellite Lake Water Temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kurs2/03%20sis-temperature-statistics.html">Temperature Statistics for Europe</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs 3:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs3/01%20senthub_downloader.html">SentinelHub Downloader</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kurs Note Defined:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01%20alpine-monthly-precipitation.html">Alpine monatliche Niederschlagsdaten</a></li>
<li class="toctree-l1"><a class="reference internal" href="02%20sis-heat-wave-and-cold-spells.html">Heat Wave and Cold Spells</a></li>
<li class="toctree-l1"><a class="reference internal" href="03%20sis-health-vector.html">SIS Health Vector</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20climate-indicators.html">Climate Indicators for Europe</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20sis-biodiversity-era5-regional.html">Downscaled bioclimatic indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20era5_land_hourly.html">ERA5-Land Hourly Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="07%20era5-land-monthly.html">ERA5-Land Monthly Averaged</a></li>
<li class="toctree-l1"><a class="reference internal" href="08%20landsat_with_landsatxplore.html">Landsat Downloader</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coklimax</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ERA5-Land Hourly Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/kurs_not_defined/06 era5_land_hourly copy.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="era5-land-hourly-data">
<h1>ERA5-Land Hourly Data<a class="headerlink" href="#era5-land-hourly-data" title="Link to this heading"></a></h1>
<p>ERA5-Land is a high-resolution reanalysis dataset that provides a consistent and detailed view of land variables over several decades, combining model data with atmospheric forcing from ERA5 to ensure accuracy. By correcting input variables for altitude differences and leveraging indirect observational influences, it offers enhanced precision for land surface applications like flood and drought forecasting. Despite some inherent uncertainties, ERA5-Land’s extensive temporal and spatial resolution makes it a valuable resource for decision-making and environmental analysis.</p>
<p><strong>Information on Dataset:</strong></p>
<ul class="simple">
<li><p>Source: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=overview'">ERA5-Land Hourly Data</a></p></li>
<li><p>Author:</p></li>
<li><p>Notebook Version: 1.1 (Updated: December 09, 2024)</p></li>
</ul>
<section id="specifying-the-paths-and-working-directories">
<h2>1. Specifying the paths and working directories<a class="headerlink" href="#specifying-the-paths-and-working-directories" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="sd">&#39;&#39;&#39; ---- Hier die Verzeichnisse angeben ---- &#39;&#39;&#39;</span>
<span class="n">download_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\era5-land-hourly-data\download&quot;</span>
<span class="n">working_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\era5-land-hourly-data\working&quot;</span>
<span class="n">geotiff_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\era5-land-hourly-data\geotiff&quot;</span>
<span class="n">csv_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\era5-land-hourly-data\csv&quot;</span>
<span class="n">output_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\era5-land-hourly-data\output&quot;</span>
<span class="sd">&#39;&#39;&#39; ----- Ende der Eingaben ---- &#39;&#39;&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">working_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">geotiff_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">csv_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-and-extract-dataset">
<h2>2. Download and Extract Dataset<a class="headerlink" href="#download-and-extract-dataset" title="Link to this heading"></a></h2>
<section id="authentication">
<h3>2.1 Authentication<a class="headerlink" href="#authentication" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cdsapi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;762ca742-36e3-42b3-8238-636a8f1ac851&quot;</span>
    <span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;https://cds.climate.copernicus.eu/api&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">api_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">api_key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="request-definition-and-download">
<h3>2.2 Request Definition and Download<a class="headerlink" href="#request-definition-and-download" title="Link to this heading"></a></h3>
<section id="create-list-of-variables">
<h4>1. Create list of variables<a class="headerlink" href="#create-list-of-variables" title="Link to this heading"></a></h4>
<p>The list of variables are available at <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=download">ERA5-Land Hourly</a></p>
<p><em>Please check and modify the predefined variable name if any issue arises with variable name.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variable Groups</span>
<span class="n">var_group_temperature</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;2m_dewpoint_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skin_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soil_temperature_level_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soil_temperature_level_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soil_temperature_level_3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;soil_temperature_level_4&quot;</span><span class="p">]</span>

<span class="n">var_group_lake</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;lake_bottom_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_ice_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_ice_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_mix_layer_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_mix_layer_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_shape_factor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake_total_layer_temperature&quot;</span><span class="p">]</span>

<span class="n">var_group_snow</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;snow_albedo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snow_cover&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snow_density&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snow_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snow_depth_water_equivalent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snowfall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snowmelt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temperature_of_snow_layer&quot;</span><span class="p">]</span>

<span class="n">var_group_soil_water</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;skin_reservoir_content&quot;</span><span class="p">,</span>
    <span class="s2">&quot;volumetric_soil_water_layer_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;volumetric_soil_water_layer_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;volumetric_soil_water_layer_3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;volumetric_soil_water_layer_4&quot;</span><span class="p">]</span>

<span class="n">var_group_radiation_and_heat</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;forecast_albedo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_latent_heat_flux&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_net_solar_radiation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_net_thermal_radiation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_sensible_heat_flux&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_solar_radiation_downwards&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_thermal_radiation_downwards&quot;</span><span class="p">]</span>

<span class="n">var_group_evaporation_and_runoff</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;evaporation_from_bare_soil&quot;</span><span class="p">,</span>
    <span class="s2">&quot;evaporation_from_open_water_surfaces_excluding_oceans&quot;</span><span class="p">,</span>
    <span class="s2">&quot;evaporation_from_the_top_of_canopy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;evaporation_from_vegetation_transpiration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;potential_evaporation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;runoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;snow_evaporation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sub_surface_runoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_runoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;total_evaporation&quot;</span><span class="p">]</span>

<span class="n">var_group_wind_pressure_and_precipitation</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;10m_u_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;10m_v_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_pressure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;total_precipitation&quot;</span><span class="p">]</span>

<span class="n">var_group_vegetation</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;leaf_area_index_high_vegetation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;leaf_area_index_low_vegetation&quot;</span><span class="p">]</span>

<span class="c1"># List of variable group</span>
<span class="n">var_group_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var_group_temperature&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_lake&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_soil_water&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_radiation_and_heat&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_evaporation_and_runoff&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_wind_pressure_and_precipitation&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;var_group_vegetation&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-request-parameters-for-download">
<h4>2. Define request parameters for download<a class="headerlink" href="#define-request-parameters-for-download" title="Link to this heading"></a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>

<span class="n">selected_variable_group</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="n">var_group_list</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">var_group_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Select a variable group&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">description_width</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;50%&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">selected_variable_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0afffb54bfee4702a12a5ca0346e86c4"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_variable_group</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_variable_group</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">selected_variable</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="n">current_variable_group</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="n">current_variable_group</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Select the variable of interest&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">description_width</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;50%&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">selected_variable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "9eb11b4e269540e69d9a56d053f96cc5"}</script></div>
</div>
</section>
<section id="define-bounding-box-extents-bbox-for-the-dataset">
<h4>3. Define Bounding Box Extents (Bbox) for the Dataset<a class="headerlink" href="#define-bounding-box-extents-bbox-for-the-dataset" title="Link to this heading"></a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define additional request fields to ensure the request stays within the file size limit.</span>
<span class="c1"># These coordinates were obtained using the BBox Extractor tool:</span>
<span class="c1"># https://str-ucture.github.io/bbox-extractor/</span>

<span class="n">bbox_wgs84_deutschland</span> <span class="o">=</span> <span class="p">[</span><span class="mf">56.0</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">,</span> <span class="mf">47.2</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span> <span class="c1"># North, West, South, East</span>
<span class="n">bbox_wgs84_konstanz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">47.9</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">47.6</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">]</span>

<span class="c1"># Alternatively, use a shapefile for precise geographic filtering</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># Example: Load shapefile of Konstanz (WGS84 projection)</span>
<span class="n">de_shapefile</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;./shapefiles/de_boundary.shp&quot;</span>
<span class="n">de_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">de_shapefile</span><span class="p">)</span>
<span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_gdf</span><span class="o">.</span><span class="n">total_bounds</span>

<span class="c1"># Adjust and buffer</span>
<span class="n">de_bounds_adjusted</span> <span class="o">=</span> <span class="p">[(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">]</span>

<span class="n">bbox_de_bounds_adjusted</span> <span class="o">=</span> <span class="p">[</span><span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">selected_year</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span> <span class="mi">2024</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
    <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">2024</span><span class="p">),</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Select the year for downloading data:&quot;</span><span class="p">,</span>
    <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">description_width</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">),</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;50%&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">selected_year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "82a06b31cf6146738acf388bd7affec7"}</script></div>
</div>
</section>
<section id="define-request-parameters">
<h4>4. Define request parameters<a class="headerlink" href="#define-request-parameters" title="Link to this heading"></a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Download data for the entire year for a variable group</span>

<span class="c1"># dataset = &quot;reanalysis-era5-land&quot;</span>
<span class="c1"># request = {</span>
<span class="c1">#     &quot;variable&quot;: selected_variable.value,</span>
<span class="c1">#     &quot;year&quot;: selected_year.value,</span>
<span class="c1">#     &quot;month&quot;: [str(month) for month in range(13)],</span>
<span class="c1">#     &quot;day&quot;: [str(day) for day in range(32)],</span>
<span class="c1">#     &quot;time&quot;: [f&quot;{hour:02d}:00&quot; for hour in range(24)],</span>
<span class="c1">#     &quot;data_format&quot;: &quot;netcdf&quot;,</span>
<span class="c1">#     &quot;download_format&quot;: &quot;unarchived&quot;,</span>
<span class="c1">#     &quot;area&quot;: bbox_de_bounds_adjusted</span>
<span class="c1"># }</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Run this cell to download the dataset:</span>

<span class="c1"># def main_retrieve():</span>
<span class="c1">#     dataset_filename = f&quot;{dataset}-{selected_variable.value}-{selected_year.value}.nc&quot;</span>
<span class="c1">#     dataset_filepath = os.path.join(download_folder, dataset_filename)</span>

<span class="c1">#     # Download the dataset only if the dataset has not been downloaded before</span>
<span class="c1">#     if not os.path.isfile(dataset_filepath):</span>
<span class="c1">#         # Download the dataset with the defined request parameters</span>
<span class="c1">#         client.retrieve(dataset, request, dataset_filepath)</span>
<span class="c1">#     else:</span>
<span class="c1">#         print(&quot;Dataset already downloaded.&quot;)</span>

<span class="c1"># if __name__ == &quot;__main__&quot;:</span>
<span class="c1">#     client = main()</span>
<span class="c1">#     main_retrieve()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for selected_year in range(2000,2008,1):</span>
<span class="c1">#     dataset = &quot;reanalysis-era5-land&quot;</span>
<span class="c1">#     request = {</span>
<span class="c1">#         &quot;variable&quot;: selected_variable.value,</span>
<span class="c1">#         &quot;year&quot;: selected_year,</span>
<span class="c1">#         &quot;month&quot;: [str(month) for month in range(13)],</span>
<span class="c1">#         &quot;day&quot;: [str(day) for day in range(32)],</span>
<span class="c1">#         &quot;time&quot;: [f&quot;{hour:02d}:00&quot; for hour in range(24)],</span>
<span class="c1">#         &quot;data_format&quot;: &quot;netcdf&quot;,</span>
<span class="c1">#         &quot;download_format&quot;: &quot;unarchived&quot;,</span>
<span class="c1">#         &quot;area&quot;: bbox_de_bounds_adjusted</span>
<span class="c1">#     }</span>

<span class="c1">#     # Run this cell to download the dataset:</span>

<span class="c1">#     def main_retrieve():</span>
<span class="c1">#         dataset_filename = f&quot;{dataset}-{selected_variable.value}-{selected_year}.nc&quot;</span>
<span class="c1">#         dataset_filepath = os.path.join(download_folder, dataset_filename)</span>

<span class="c1">#         # Download the dataset only if the dataset has not been downloaded before</span>
<span class="c1">#         if not os.path.isfile(dataset_filepath):</span>
<span class="c1">#             # Download the dataset with the defined request parameters</span>
<span class="c1">#             client.retrieve(dataset, request, dataset_filepath)</span>
<span class="c1">#         else:</span>
<span class="c1">#             print(&quot;Dataset already downloaded.&quot;)</span>

<span class="c1">#     if __name__ == &quot;__main__&quot;:</span>
<span class="c1">#         client = main()</span>
<span class="c1">#         main_retrieve()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, str.ucture GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>