

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Downscaled bioclimatic indicators &mdash; CoKLIMAx 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2bfa0ee5" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="application/vnd.jupyter.widget-state+json">{"state": {"5140bdfb0db54c71887eccbe3a589bae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "55ebcccc06b94ceaa2fe1259d246d2de": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4a1cd7679e5b45e684e0489f3e095bb7": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5140bdfb0db54c71887eccbe3a589bae", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_55ebcccc06b94ceaa2fe1259d246d2de", "tabbable": null, "tooltip": null, "value": 1.0}}, "d14ba6ba3fab4f7ab31d57a2daec2528": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "64c52290f00043ea811ab1973b639a34": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "efff43cdd13049dcb5336ea595e33c99": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d14ba6ba3fab4f7ab31d57a2daec2528", "placeholder": "\u200b", "style": "IPY_MODEL_64c52290f00043ea811ab1973b639a34", "tabbable": null, "tooltip": null, "value": "Exporting\u2007merged\u2007GeoTIFF\u2007file\u2007from\u20071999\u2007to\u20071999:\u2007100%"}}, "3e29a50879ad4b4a9fc5696ba81c3dcc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "33e5c77503a44661a9c724e7ea006d5d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "7b40f60de7294bf69aa034e5f7f15b50": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3e29a50879ad4b4a9fc5696ba81c3dcc", "placeholder": "\u200b", "style": "IPY_MODEL_33e5c77503a44661a9c724e7ea006d5d", "tabbable": null, "tooltip": null, "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007167.74it/s]"}}, "284fcb76fd554bbd8efb8a6affa8b314": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "74f2ea4967d84297a06180bf5b15fc6a": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_efff43cdd13049dcb5336ea595e33c99", "IPY_MODEL_4a1cd7679e5b45e684e0489f3e095bb7", "IPY_MODEL_7b40f60de7294bf69aa034e5f7f15b50"], "layout": "IPY_MODEL_284fcb76fd554bbd8efb8a6affa8b314", "tabbable": null, "tooltip": null}}, "6e1689d29e5b48789451de30c53eb551": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a5440ad86c184fc593e40931c033ba2a": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "dab79a9f87164e7d8160dbfc47eed29e": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6e1689d29e5b48789451de30c53eb551", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_a5440ad86c184fc593e40931c033ba2a", "tabbable": null, "tooltip": null, "value": 1.0}}, "a23c1d92acc34cb497c530f7aa32f4af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a2005f3ab1d242d8822dc54dcafb5f54": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f5c081bab2a04bee9beb1199bbffc2b3": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a23c1d92acc34cb497c530f7aa32f4af", "placeholder": "\u200b", "style": "IPY_MODEL_a2005f3ab1d242d8822dc54dcafb5f54", "tabbable": null, "tooltip": null, "value": "Exporting\u2007merged\u2007GeoTIFF\u2007file\u2007from\u20071999\u2007to\u20071999:\u2007100%"}}, "ef46923880154beeaeac5ce7485a7bc2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8e6db411289b45c7a9772ecfb99ce358": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "2caef6bea960421cb6e74f836ad7863f": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_ef46923880154beeaeac5ce7485a7bc2", "placeholder": "\u200b", "style": "IPY_MODEL_8e6db411289b45c7a9772ecfb99ce358", "tabbable": null, "tooltip": null, "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007161.05it/s]"}}, "67bb243644ae4bc58b6f43a3342d2015": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "477feeb63896465fb1d7f295a3cdd336": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f5c081bab2a04bee9beb1199bbffc2b3", "IPY_MODEL_dab79a9f87164e7d8160dbfc47eed29e", "IPY_MODEL_2caef6bea960421cb6e74f836ad7863f"], "layout": "IPY_MODEL_67bb243644ae4bc58b6f43a3342d2015", "tabbable": null, "tooltip": null}}, "fcf2b475b5c340e38eaeabf58d562e19": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "33ff754c37574244b1a1f45f8d5c9c85": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ae30063c3ec34f64839c8cfc2c1f2b68": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fcf2b475b5c340e38eaeabf58d562e19", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_33ff754c37574244b1a1f45f8d5c9c85", "tabbable": null, "tooltip": null, "value": 1.0}}, "3b41fe94e8b448b284fc51a40ca52ef1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c56423a7e2b4833bb802ea8046571a0": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c37ddb5ecb3c4ae2a6a8a267ad5cd9a7": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3b41fe94e8b448b284fc51a40ca52ef1", "placeholder": "\u200b", "style": "IPY_MODEL_1c56423a7e2b4833bb802ea8046571a0", "tabbable": null, "tooltip": null, "value": "Exporting\u2007merged\u2007GeoTIFF\u2007file\u2007from\u20071999\u2007to\u20071999:\u2007100%"}}, "9257cc0d38ec401b84758d389c8296d8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "313232221b534fa49dbcce6efed571f8": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "52b3229809074e539e5ce23e3a778f5d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9257cc0d38ec401b84758d389c8296d8", "placeholder": "\u200b", "style": "IPY_MODEL_313232221b534fa49dbcce6efed571f8", "tabbable": null, "tooltip": null, "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007153.27it/s]"}}, "6088c69cb07c49a59d8fbd667759f1fb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c9d7452720334f5a909e7419bba6cb51": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c37ddb5ecb3c4ae2a6a8a267ad5cd9a7", "IPY_MODEL_ae30063c3ec34f64839c8cfc2c1f2b68", "IPY_MODEL_52b3229809074e539e5ce23e3a778f5d"], "layout": "IPY_MODEL_6088c69cb07c49a59d8fbd667759f1fb", "tabbable": null, "tooltip": null}}, "a84ae3194d7b4d2791014937bc9d0b85": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cac3b8a8429448ed8b626d3e5d9e80b2": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "5f366c0d0c6f4ceeb0cb92724dc9d9b9": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a84ae3194d7b4d2791014937bc9d0b85", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_cac3b8a8429448ed8b626d3e5d9e80b2", "tabbable": null, "tooltip": null, "value": 1.0}}, "e03e9739359b4441a56ad2afdee04955": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36bc88e6a750461b99cdd684e894bf0d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "aa9bdf7f479741b68fb0cd20fa1129b8": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e03e9739359b4441a56ad2afdee04955", "placeholder": "\u200b", "style": "IPY_MODEL_36bc88e6a750461b99cdd684e894bf0d", "tabbable": null, "tooltip": null, "value": "Exporting\u2007merged\u2007GeoTIFF\u2007file\u2007from\u20071999\u2007to\u20071999:\u2007100%"}}, "9300f13427e343fdb9fae93422c5b962": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b95be7117be14eac9adc10beb11859e6": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c065465cefd24a48851c7aba7f05135e": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9300f13427e343fdb9fae93422c5b962", "placeholder": "\u200b", "style": "IPY_MODEL_b95be7117be14eac9adc10beb11859e6", "tabbable": null, "tooltip": null, "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007165.25it/s]"}}, "24acd4756dee4f4e854daf35043d8990": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "96cd85d9bbd84e1e9e3694c5fdf587c7": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_aa9bdf7f479741b68fb0cd20fa1129b8", "IPY_MODEL_5f366c0d0c6f4ceeb0cb92724dc9d9b9", "IPY_MODEL_c065465cefd24a48851c7aba7f05135e"], "layout": "IPY_MODEL_24acd4756dee4f4e854daf35043d8990", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
      <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ERA5-Land Hourly Data" href="06_era5_land_hourly.html" />
    <link rel="prev" title="Climate Indicators for Europe" href="04_climate-indicators.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CoKLIMAx
              <img src="../../_static/coklimax_logo_new.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html">Required Software and Knowledge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#setting-up-the-infrastructure-on-a-windows-system">Setting Up the Infrastructure on a Windows System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#installing-python-and-jupyter-notebook">Installing Python and Jupyter Notebook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#python-and-pip">1. Python and Pip:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#installing-jupyter-notebook">2. Installing Jupyter Notebook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#starting-jupyter-notebook-for-course-elements">Starting Jupyter Notebook for Course Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_inhalte/01_SoftwareKenntnisse.html#required-knowledge">Required Knowledge</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_inhalte/02_Kurs-Elemente.html">The Course Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_inhalte/03_CDS.html">The Copernicus Climate Data Store (CDS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Course 1:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../rst_kurs1/Element_1.html">Element 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_1.html#learning-objectives">Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_1.html#setting-up-the-cds-api">Setting Up the CDS API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_1.html#personal-api-key">1. Personal API Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_1.html#installation-of-the-cds-api">2. Installation of the CDS API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_1.html#downloading-climate-data-from-the-cds">Downloading Climate Data from the CDS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_1.html#creating-the-api-request">1. Creating the API Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_1.html#the-api-request-in-jupyter-notebook">2. The API Request in Jupyter Notebook</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_kurs1/Element_2.html">Element 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_2.html#learning-objectives">Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_2.html#handling-netcdf-files">Handling NetCDF Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_2.html#unpacking-the-netcdf-zip-file">1. Unpacking the NetCDF Zip file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_2.html#examining-a-netcdf-file">2. Examining a NetCDF File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rst_kurs1/Element_2.html#visualization-and-selection-of-a-region">Visualization and Selection of a Region</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_2.html#reading-and-exploring-the-data">1. Reading and Exploring the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_2.html#creating-a-plot-for-august-1980">2. Creating a Plot for August 1980</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rst_kurs1/Element_2.html#creating-a-plot-for-a-time-series">3. Creating a Plot for a Time Series</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Course 2:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html">Lake Water Temperature from Satellite Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#download-and-extract-the-dataset">2. Download and Extract the Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#define-the-request-and-download-the-dataset">2.2 Define the “request” and Download the Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#extract-the-zip-files-in-folder-s">2.3 Extract the ZIP files in folder(s)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#merge-netcdf4-files-into-a-single-netcdf4-file">3. Merge NetCDF4 Files into a Single NetCDF4 File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#investigate-the-metadata-of-the-netcdf4-file">4. Investigate the Metadata of the NetCDF4 file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#export-the-time-series-in-csv-format">5. Export the time series in CSV Format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#define-a-function-to-compute-daily-average">5.1 Define a Function to Compute Daily Average</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#create-merged-dataframe-for-yearly-data-and-export-as-csv">5.2 Create Merged DataFrame for yearly data and Export as CSV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#analysis-and-visualization-options">6. Analysis and Visualization Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#visualization-of-daily-average-with-line-graph">6.1 Visualization of Daily Average with Line Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#visualization-of-monthly-average-with-line-graph">6.2 Visualization of Monthly Average with Line Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#visualization-of-monthly-average-with-bar-graph">6.3 Visualization of Monthly Average with Bar Graph</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#export-the-merged-netcdf4-file-to-geotiff">7. Export the Merged NetCDF4 file to GeoTIFF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#export-all-year-dataset-as-merged-geotiff-file">7.1 Export All-Year Dataset as Merged GeoTIFF File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#export-all-year-dataset-as-individual-geotiff-file">7.2 Export All-Year Dataset as Individual GeoTIFF File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/02_satellite-lake-water-temperature.html#visualize-all-available-data-from-1995-to-2023">8. Visualize all available data from 1995 to 2023</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html">Temperature Statistics for Europe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#download-and-extract-the-dataset">2. Download and Extract the Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#define-the-request-and-download-the-dataset">2.2 Define the “request” and Download the Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#extract-the-zip-files-in-folder-s">2.3 Extract the ZIP files in folder(s)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#read-the-netcdf-file-and-print-the-metadata">3. Read the NetCDF File and Print the Metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#create-a-dataframe-of-available-netcdf-files">3.1 Create a Dataframe of Available netCDF Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#overview-of-the-downloaded-data-structure">3.1 Overview of the Downloaded Data Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#print-unique-variable-name-s-and-available-variables">3.2 Print unique Variable name(s) and Available Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#define-a-function-to-convert-netcdf-data-to-a-pandas-dataframe">4.1 Define a function to convert NetCDF data to a pandas DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#create-merged-dataframe-and-export-as-csv">4.2 Create Merged DataFrame and Export as CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#filter-by-area-create-dataframe-and-export-as-merged-csv-file">4.2 Filter by Area, Create DataFrame and Export as merged CSV file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#export-dataset-to-geotiff">5. Export Dataset to GeoTIFF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#function-to-exort-the-dataset-as-geotiff-file-s">5.1 Function to exort the Dataset as GeoTIFF File(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#export-selected-dataset-to-geotiff">5.2 Export selected dataset to GeoTIFF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kurs2/03_sis-temperature-statistics.html#plot-using-matplotlib">6. Plot using Matplotlib</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Jupyter Notebook Library:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../rst_jupyter_bibliothek/index.html">Über CoKLIMAx-II Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../rst_jupyter_bibliothek/cds_data/index.html">CDS Dataset Notebooks </a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_alpine-monthly-precipitation.html">Alpine monatliche Niederschlagsdaten</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#download-and-extract-the-dataset">2. Download and Extract the Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#define-the-request-and-download-the-dataset">2.2 Define the “request” and Download the Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#extract-zip-folder-s">2.3 Extract Zip Folder(s)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the Metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#print-netcdf-metadata">3.1 Print netCDF metadata</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#define-bounding-box-to-filter-data-for-konstanz">4.1 Define Bounding Box to Filter Data for Konstanz</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#filter-data-by-bounding-box-and-export-as-csv">4.2 Filter Data by Bounding Box and Export as CSV</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#compute-monthly-means-and-export-as-csv">4.3 Compute Monthly Means and Export as CSV</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#plot-monthly-averages-for-a-defined-date-range">4.4 Plot Monthly Averages for a Defined Date Range</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#export-dataset-to-geotiff">5. Export Dataset to GeoTIFF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#export-all-year-dataset-as-individual-geotiff-files">5.1 Export All-Year Dataset as Individual GeoTIFF Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#export-dataset-as-a-single-merged-geotiff-file">5.2 Export Dataset as a Single Merged GeoTIFF File</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#export-data-for-a-defined-date-range-and-area">5.3 Export Data for a Defined Date Range and Area</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="01_alpine-monthly-precipitation.html#plot-using-matplotlib">6. Plot using Matplotlib</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#plot-the-complete-data">6.1 Plot the Complete data</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_alpine-monthly-precipitation.html#plot-monthly-mean-heatmap">6.2 Plot monthly mean heatmap</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html">Heat Wave and Cold Spells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#api-authentication">2.1 API Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#create-a-dataframe-of-available-netcdf-files">3.1 Create a Dataframe of Available netCDF Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#print-unique-variable-name-s-and-available-variables">3.1 Print unique Variable name(s) and Available Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#create-dataframe-and-export-as-merged-csv-file">4.1 Create DataFrame and Export as merged CSV file</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#filter-by-area-create-dataframe-and-export-as-merged-csv-file">4.2 Filter by Area, Create DataFrame and Export as merged CSV file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#export-dataset-to-geotiff">5. Export Dataset to GeoTIFF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#function-to-exort-the-dataset-as-geotiff-file-s">5.1 Function to exort the Dataset as GeoTIFF File(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#export-selected-dataset-to-geotiff">5.2 Export selected dataset to GeoTIFF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#plot-using-matplotlib">6. Plot using Matplotlib</a><ul>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#line-graph-with-error">6.2 Line graph with error</a></li>
<li class="toctree-l4"><a class="reference internal" href="02_sis-heat-wave-and-cold-spells.html#heatmap">6.2 Heatmap</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03_sis-health-vector.html">SIS Health Vector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#api-authentication">2.1 API Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#create-individual-dataframe-and-export-as-individual-csv-files">4.1 Create Individual DataFrame and Export as Individual CSV files</a></li>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#create-dataframe-and-export-as-merged-csv-file">4.2 Create DataFrame and Export as merged CSV file</a></li>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#filter-by-area-create-dataframe-and-export-as-merged-csv-file">4.2 Filter by Area, Create DataFrame and Export as merged CSV file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#export-dataset-to-geotiff">5. Export Dataset to GeoTIFF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#function-to-export-the-dataset-as-geotiff-file-s">5.1 Function to export the Dataset as GeoTIFF File(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="03_sis-health-vector.html#export-selected-dataset-to-geotiff">5.2 Export selected dataset to GeoTIFF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="03_sis-health-vector.html#plot-using-matplotlib">6. Plot using Matplotlib</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="04_climate-indicators.html">Climate Indicators for Europe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="04_climate-indicators.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_climate-indicators.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#define-request-for-only-heat-and-cold">2.3 Define request for only heat and cold</a></li>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#request-defined-by-tim">2.4 Request defined by Tim</a></li>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="04_climate-indicators.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#print-unique-variable-name-s-and-available-variables">3.1 Print unique Variable name(s) and Available Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="04_climate-indicators.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#filter-by-bounding-box-create-dataframe-and-export-as-merged-csv-file">4.1 Filter by Bounding Box, Create DataFrame and Export as merged CSV file</a></li>
<li class="toctree-l4"><a class="reference internal" href="04_climate-indicators.html#error-bar-chart-for-reanalysis">Error bar chart for reanalysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Downscaled bioclimatic indicators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-and-extract-the-dataset">2. Download and Extract the Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#define-the-request-and-download-the-dataset">2.2 Define the “request” and Download the Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extract-the-zip-folder-s">2.3 Extract the Zip Folder(s)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#read-the-netcdf4-file-and-print-the-metadata">3. Read the netCDF4 file and print the Metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-a-dataframe-of-available-netcdf-files">3.1 Create a Dataframe of Available netCDF Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#print-unique-variable-name-s-and-available-variables">3.2 Print unique Variable name(s) and Available Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#define-a-function-to-convert-netcdf-data-to-a-pandas-dataframe">4.1 Define a function to convert NetCDF data to a pandas DataFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filter-by-bounding-box-create-dataframe-and-export-as-merged-csv-file">4.2 Filter by Bounding Box, Create DataFrame and Export as merged CSV file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#export-dataset-to-geotiff">5. Export Dataset to GeoTIFF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-using-matplotlib">6. Plot using Matplotlib</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot-the-complete-data">6.1 Plot the Complete data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="06_era5_land_hourly.html">ERA5-Land Hourly Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="06_era5_land_hourly.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_era5_land_hourly.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="06_era5_land_hourly.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="06_era5_land_hourly.html#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="06_era5_land_hourly.html#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="06_era5_land_hourly.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="06_era5_land_hourly.html#print-unique-variable-name-s-and-available-variables">3.1 Print unique Variable name(s) and Available Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="06_era5_land_hourly.html#export-dataset-to-csv">4. Export Dataset to CSV</a><ul>
<li class="toctree-l4"><a class="reference internal" href="06_era5_land_hourly.html#filter-by-bounding-box-create-dataframe-and-export-as-merged-csv-file">4.1 Filter by Bounding Box, Create DataFrame and Export as merged CSV file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="07_era5-land-monthly.html">ERA5-Land Monthly Averaged</a><ul>
<li class="toctree-l3"><a class="reference internal" href="07_era5-land-monthly.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="07_era5-land-monthly.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="07_era5-land-monthly.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="07_era5-land-monthly.html#request-definition-and-download">2.2 Request Definition and Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="07_era5-land-monthly.html#extract-the-zip-folder">2.3 Extract the Zip folder</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="07_era5-land-monthly.html#read-the-netcdf-file-and-print-the-metadata">3. Read the netCDF file and print the metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="07_era5-land-monthly.html#export-dataset-to-csv">4. Export Dataset to CSV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="10_c3s-erderwaermung.html">Global Warming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="10_c3s-erderwaermung.html#codes">Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_c3s-erderwaermung.html#era5">ERA5</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_c3s-erderwaermung.html#ecv">ECV</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_c3s-erderwaermung.html#ipcc">IPCC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_jupyter_bibliothek/satellite_data/index.html">Satellite Data Notebooks </a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kurs3/01_senthub_downloader.html">SentinelHub Satellite Data Explorer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#filter-data-collection-and-retrieve-satellite-images">2. Filter Data Collection and Retrieve Satellite Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#api-and-authentication">2.1 API and Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#define-data-query-parameters">2.2 Define Data Query Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#retrieve-filtered-dataset-using-sentinelhubcatalog">2.3 Retrieve Filtered Dataset Using SentinelHubCatalog</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#download-and-visualize-satellite-data">3. Download and Visualize Satellite Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#evaluation-scripts">3.1 Evaluation scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#request-satellite-data-and-create-plots">3.2 Request Satellite Data and create Plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#save-image-as-a-geotiff-raster">4. Save Image as a GeoTIFF Raster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#visualize-the-raster">5. Visualize the Raster</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#visualize-the-saved-true-color-raster-using-folium">5.1 Visualize the Saved True Color Raster Using <strong>Folium</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#visualize-a-false-color-composite-using-matplotlib">5.2 Visualize a False Color Composite Using <strong>Matplotlib</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#calculate-and-plot-remote-sensing-indices">5.3 Calculate and Plot Remote Sensing <strong>Indices</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../kurs3/01_senthub_downloader.html#supplements">6 Supplements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="09_Sentinel2-without-esri.html">Sentinel 2 - Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="09_Sentinel2-without-esri.html#specifying-the-paths-and-working-directories">1. Specifying the paths and working directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_Sentinel2-without-esri.html#download-the-datasets">2. Download the datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_Sentinel2-without-esri.html#extract-scenes">3. Extract scenes</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_Sentinel2-without-esri.html#select-scene-from-extracted-for-processing">4. Select scene from extracted for processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_Sentinel2-without-esri.html#process">Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="08_landsat-with-landsatxplore.html">Landsat Downloader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="08_landsat-with-landsatxplore.html#specifying-the-paths-and-working-directories">1. Specifying the Paths and Working Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_landsat-with-landsatxplore.html#download-and-extract-dataset">2. Download and Extract Dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="08_landsat-with-landsatxplore.html#authentication">2.1 Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="08_landsat-with-landsatxplore.html#search-for-available-scenes">2.2 Search for Available Scenes</a></li>
<li class="toctree-l4"><a class="reference internal" href="08_landsat-with-landsatxplore.html#visualizing-scene-polygons-on-a-map">2.3 Visualizing Scene Polygons on a Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="08_landsat-with-landsatxplore.html#download-scenes-using-display-id">2.4 Download Scenes Using Display ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="08_landsat-with-landsatxplore.html#extract-the-tar-file">2.5 Extract the TAR File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="08_landsat-with-landsatxplore.html#merge-rgb-bands-into-a-single-geotiff-file">3. Merge RGB Bands into a Single GeoTIFF File</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_landsat-with-landsatxplore.html#calculate-indices">4. Calculate Indices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rst_jupyter_bibliothek/visualizations/index.html">Visualization Options Library</a><ul class="simple">
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CoKLIMAx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../rst_jupyter_bibliothek/cds_data/index.html">CDS Dataset Notebooks </a></li>
      <li class="breadcrumb-item active">Downscaled bioclimatic indicators</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/kurs_not_defined/05_sis-biodiversity-era5-regional.ipynb.txt" rel="nofollow"> View page source</a>
<div id='language-switcher' style='text-align: right; margin-top: 10px;'>
    <select onchange="location = this.value;">
        <option value='/./CoKLIMAx-II/en/notebooks\kurs_not_defined\05_sis-biodiversity-era5-regional.html' selected>EN</option>
        <option value='/./CoKLIMAx-II/de/notebooks\kurs_not_defined\05_sis-biodiversity-era5-regional.html'>DE</option>
    </select>
</div>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="downscaled-bioclimatic-indicators">
<h1>Downscaled bioclimatic indicators<a class="headerlink" href="#downscaled-bioclimatic-indicators" title="Link to this heading"></a></h1>
<p>This dataset provides 76 bioclimatic indicators at a 1 x 1 km resolution for Europe, Northern Brazil, and Central Africa, reconstructed using ERA5 (ERA5-Land) reanalysis data and statistical downscaling. These indicators, focused on biodiversity and ecosystem services, include variables like surface energy, drought, soil moisture, wind, and Essential Climate Variables. Designed for the biodiversity community, the dataset supports diverse applications by offering temporal resolutions ranging from monthly to multi-annual averages.</p>
<p><strong>Information on Dataset:</strong></p>
<ul class="simple">
<li><p>Source: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/sis-biodiversity-era5-regional?tab=overview" rel="noopener noreferrer" target="_blank">Downscaled Bioclimatic Indicators</a></p></li>
<li><p>Author:</p></li>
<li><p>Notebook Version: 1.1 (Updated: January 21, 2025)</p></li>
</ul>
<section id="specifying-the-paths-and-working-directories">
<h2>1. Specifying the paths and working directories<a class="headerlink" href="#specifying-the-paths-and-working-directories" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="sd">&#39;&#39;&#39; ---- Specify Directories Here ---- &#39;&#39;&#39;</span>
<span class="n">download_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-biodiversity-era5-regional\download&quot;</span>
<span class="n">working_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-biodiversity-era5-regional\working&quot;</span>
<span class="n">geotiff_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-biodiversity-era5-regional\geotiff&quot;</span>
<span class="n">csv_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-biodiversity-era5-regional\csv&quot;</span>
<span class="n">output_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.\data\sis-biodiversity-era5-regional\output&quot;</span>
<span class="sd">&#39;&#39;&#39; ----- End of Declaration ---- &#39;&#39;&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">working_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">geotiff_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">csv_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-and-extract-the-dataset">
<h2>2. Download and Extract the Dataset<a class="headerlink" href="#download-and-extract-the-dataset" title="Link to this heading"></a></h2>
<section id="authentication">
<h3>2.1 Authentication<a class="headerlink" href="#authentication" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cdsapi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="c1"># API key for authentication</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;fdae60fd-35d4-436f-825c-c63fedab94a4&quot;</span>
    <span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;https://cds.climate.copernicus.eu/api&quot;</span>

    <span class="c1"># Creation of the CDS API client</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">api_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">api_key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-request-and-download-the-dataset">
<h3>2.2 Define the “request” and Download the Dataset<a class="headerlink" href="#define-the-request-and-download-the-dataset" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define additional request fields to ensure the request stays within the file size limit.</span>
<span class="c1"># These coordinates were obtained using the BBox Extractor tool:</span>
<span class="c1"># https://str-ucture.github.io/bbox-extractor/</span>

<span class="n">bbox_wgs84_deutschland</span> <span class="o">=</span> <span class="p">[</span><span class="mf">56.0</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">,</span> <span class="mf">47.2</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]</span>
<span class="n">bbox_wgs84_konstanz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">47.9</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">47.6</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">]</span>

<span class="c1"># Alternatively, use a shapefile for precise geographic filtering</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># Example: Load shapefile of Konstanz (WGS84 projection)</span>
<span class="n">de_shapefile</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;./shapefiles/de_boundary.shp&quot;</span>
<span class="n">de_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">de_shapefile</span><span class="p">)</span>
<span class="n">de_bounds</span> <span class="o">=</span> <span class="n">de_gdf</span><span class="o">.</span><span class="n">total_bounds</span>

<span class="c1"># Adjust and buffer</span>
<span class="n">de_bounds_adjusted</span> <span class="o">=</span> <span class="p">[(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span>
                      <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">de_bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mf">0.1</span><span class="p">]</span>

<span class="n">bbox_de_bounds_adjusted</span> <span class="o">=</span> <span class="p">[</span><span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">de_bounds_adjusted</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Currently for Region == Europe, only ERA5 is available</span>
<span class="c1"># for Region == Central Africa, ERA5 is available</span>
<span class="c1"># for Region == Northern Brazil, ERA5-Land is available</span>

<span class="c1">## Variable group: Bioclimatic indicators as in WORLDCLIM</span>
<span class="c1"># cds.climate.copernicus.eu/datasets/sis-biodiversity-era5-regional?tab=download</span>
<span class="n">variable_group</span> <span class="o">=</span> <span class="s2">&quot;bioclimatic_indicators_as_in_worldclim&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;sis-biodiversity-era5-regional&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;europe&quot;</span><span class="p">],</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;era5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;annual_mean_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_diurnal_range&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isothermality&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temperature_seasonality&quot;</span><span class="p">,</span>
        <span class="s2">&quot;maximum_temperature_of_warmest_month&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_temperature_of_coldest_month&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temperature_annual_range&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_temperature_of_wettest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_temperature_of_driest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_temperature_of_warmest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_temperature_of_coldest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;annual_precipitation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_wettest_month&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_driest_month&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_seasonality&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_wettest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_driest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_warmest_quarter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;precipitation_of_coldest_quarter&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;median&quot;</span><span class="p">,</span>
        <span class="s2">&quot;25th_quartile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;75th_quartile&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1_0&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Execute it to download the dataset:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main_retrieve</span><span class="p">():</span>
    <span class="n">dataset_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">variable_group</span><span class="si">}</span><span class="s2">.zip&quot;</span>
    <span class="n">dataset_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">dataset_filename</span><span class="p">)</span>

    <span class="c1"># Download the dataset only if the dataset has not been downloaded before</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dataset_filepath</span><span class="p">):</span>
        <span class="c1"># Download the dataset with the defined request parameters</span>
        <span class="n">client</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">dataset_filepath</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataset already downloaded.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">main</span><span class="p">()</span>
    <span class="n">main_retrieve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-02-19 09:58:24,774 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-02-19 09:58:24,775 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already downloaded.
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-the-zip-folder-s">
<h3>2.3 Extract the Zip Folder(s)<a class="headerlink" href="#extract-the-zip-folder-s" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>

<span class="c1"># Create the folder path to extract Zip file(s) based on the variable group</span>
<span class="n">extract_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">working_folder</span><span class="p">,</span> <span class="n">variable_group</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Extract the ZIP file</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">):</span>
        <span class="n">dataset_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">variable_group</span><span class="si">}</span><span class="s2">.zip&quot;</span>
        <span class="n">dataset_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">dataset_filename</span><span class="p">)</span>
        
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">dataset_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully extracted files to: </span><span class="si">{</span><span class="n">extract_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Folder is not empty. Skipping extraction.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: The file </span><span class="si">{</span><span class="n">dataset_filepath</span><span class="si">}</span><span class="s2"> was not found.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: The file </span><span class="si">{</span><span class="n">dataset_filepath</span><span class="si">}</span><span class="s2"> is not a valid zip file.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Folder is not empty. Skipping extraction.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="read-the-netcdf4-file-and-print-the-metadata">
<h2>3. Read the netCDF4 file and print the Metadata<a class="headerlink" href="#read-the-netcdf4-file-and-print-the-metadata" title="Link to this heading"></a></h2>
<section id="create-a-dataframe-of-available-netcdf-files">
<h3>3.1 Create a Dataframe of Available netCDF Files<a class="headerlink" href="#create-a-dataframe-of-available-netcdf-files" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">netCDF4</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="c1"># Match the filename against the expected pattern</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;(?P&lt;ds_variable&gt;BIO\d</span><span class="si">{2}</span><span class="s2">)_(?P&lt;ds_origin&gt;[\w-]+)-(?P&lt;statistic&gt;mean|median|q25|q75)_v(?P&lt;version&gt;\d+\.\d+)&quot;</span><span class="p">,</span>
        <span class="n">filename</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the given filename does not fit the expected naming scheme&quot;</span><span class="p">)</span>
    
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    
    <span class="c1"># Extract primary variable and its shape from the NetCDF file</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_nc_variable</span><span class="p">():</span>
        <span class="k">with</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
            <span class="n">variable_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="n">primary_variable_index</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Adjust this index as needed</span>
            <span class="k">if</span> <span class="n">primary_variable_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variable_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Primary variable index is out of range for the NetCDF variables.&quot;</span><span class="p">)</span>
            
            <span class="n">primary_variable</span> <span class="o">=</span> <span class="n">variable_names</span><span class="p">[</span><span class="n">primary_variable_index</span><span class="p">]</span>
            <span class="n">primary_variable_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nc_dataset</span><span class="p">[</span><span class="n">primary_variable</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">primary_variable</span><span class="p">,</span> <span class="n">primary_variable_shape</span>
    
    <span class="c1"># Return metadata as a dictionary</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
        <span class="n">ds_variable</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;ds_variable&#39;</span><span class="p">),</span>
        <span class="n">ds_origin</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;ds_origin&#39;</span><span class="p">),</span>
        <span class="n">variable_name</span><span class="o">=</span><span class="n">get_nc_variable</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">variable_shape</span><span class="o">=</span><span class="n">get_nc_variable</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">statistic</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;statistic&#39;</span><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Extract metadata for all NetCDF files in the folder</span>
<span class="n">nc_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">meta</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">extract_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.nc&#39;</span><span class="p">)]</span>
<span class="n">df_nc_files</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">nc_files</span><span class="p">)</span>

<span class="c1"># Modify pandas display options</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_colwidth</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># Display the DataFrame without displaying the &#39;path&#39; column</span>
<span class="n">df_nc_files</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df_nc_files</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s1">&#39;path&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>ds_variable</th>
      <th>ds_origin</th>
      <th>variable_name</th>
      <th>variable_shape</th>
      <th>statistic</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BIO01_era5-to-1km_1979-201...</td>
      <td>BIO01</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO01</td>
      <td>(1, 4800, 9600)</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BIO01_era5-to-1km_1979-201...</td>
      <td>BIO01</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO01</td>
      <td>(1, 4800, 9600)</td>
      <td>median</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BIO01_era5-to-1km_1979-201...</td>
      <td>BIO01</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO01</td>
      <td>(1, 4800, 9600)</td>
      <td>q25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BIO01_era5-to-1km_1979-201...</td>
      <td>BIO01</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO01</td>
      <td>(1, 4800, 9600)</td>
      <td>q75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BIO02_era5-to-1km_1979-201...</td>
      <td>BIO02</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO02</td>
      <td>(1, 4800, 9600)</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>BIO18_era5-to-1km_1979-201...</td>
      <td>BIO18</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO18</td>
      <td>(1, 4800, 9600)</td>
      <td>q75</td>
    </tr>
    <tr>
      <th>72</th>
      <td>BIO19_era5-to-1km_1979-201...</td>
      <td>BIO19</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO19</td>
      <td>(1, 4800, 9600)</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>73</th>
      <td>BIO19_era5-to-1km_1979-201...</td>
      <td>BIO19</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO19</td>
      <td>(1, 4800, 9600)</td>
      <td>median</td>
    </tr>
    <tr>
      <th>74</th>
      <td>BIO19_era5-to-1km_1979-201...</td>
      <td>BIO19</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO19</td>
      <td>(1, 4800, 9600)</td>
      <td>q25</td>
    </tr>
    <tr>
      <th>75</th>
      <td>BIO19_era5-to-1km_1979-201...</td>
      <td>BIO19</td>
      <td>era5-to-1km_1979-2018</td>
      <td>BIO19</td>
      <td>(1, 4800, 9600)</td>
      <td>q75</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="print-unique-variable-name-s-and-available-variables">
<h3>3.2 Print unique Variable name(s) and Available Variables<a class="headerlink" href="#print-unique-variable-name-s-and-available-variables" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Keep track of processed variable names to avoid duplicates</span>
<span class="n">seen_variables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># List all variables in each NetCDF file</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nc_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nc_files</span><span class="p">):</span>
    <span class="n">variable_name</span> <span class="o">=</span> <span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]</span>
    
    <span class="c1"># Skip if the variable has already been processed</span>
    <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="n">seen_variables</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># Open the NetCDF file in read </span>
    <span class="k">with</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
        <span class="c1"># List all variables in the current dataset</span>
        <span class="n">variables_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        
        <span class="c1"># Print details of the file and its variables</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">&lt;2</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">variable_name</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">: Available variables: </span><span class="si">{</span><span class="n">variables_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Mark this variable as seen</span>
    <span class="n">seen_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1  BIO01   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO01&#39;]
5  BIO02   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO02&#39;]
9  BIO03   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO03&#39;]
13 BIO04   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO04&#39;]
17 BIO05   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO05&#39;]
21 BIO06   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO06&#39;]
25 BIO07   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO07&#39;]
29 BIO08   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO08&#39;]
33 BIO09   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO09&#39;]
37 BIO10   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO10&#39;]
41 BIO11   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO11&#39;]
45 BIO12   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO12&#39;]
49 BIO13   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO13&#39;]
53 BIO14   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO14&#39;]
57 BIO15   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO15&#39;]
61 BIO16   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO16&#39;]
65 BIO17   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO17&#39;]
69 BIO18   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO18&#39;]
73 BIO19   : Available variables: [&#39;latitude&#39;, &#39;longitude&#39;, &#39;time&#39;, &#39;BIO19&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract information from the first NetCDF file</span>
<span class="n">nc_file</span> <span class="o">=</span> <span class="n">nc_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Open the NetCDF file in read mode</span>
<span class="k">with</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
    <span class="c1"># Retrieve a list of all variable names in the dataset</span>
    <span class="n">variables_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    
    <span class="c1"># Initialize a list to hold the rows of the DataFrame</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Loop through all variables in the dataset</span>
    <span class="k">for</span> <span class="n">test_var</span> <span class="ow">in</span> <span class="n">variables_list</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get the variable object</span>
            <span class="n">var_obj</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">test_var</span><span class="p">]</span>
            
            <span class="c1"># Extract attributes: units (default to &#39;N/A&#39; if not present) and shape</span>
            <span class="n">unit</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">var_obj</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">var_obj</span><span class="o">.</span><span class="n">shape</span>
            
            <span class="c1"># Append the extracted details to the rows list</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;nc_variables&quot;</span><span class="p">:</span> <span class="n">test_var</span><span class="p">,</span>
                <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">unit</span><span class="p">,</span>
                <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="n">shape</span>
            <span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Handle any errors and continue processing other variables</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing variable &#39;</span><span class="si">{</span><span class="n">test_var</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create a DataFrame from the rows</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<span class="c1"># Display the DataFrame</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>nc_variables</th>
      <th>unit</th>
      <th>shape</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>latitude</td>
      <td>degrees_north</td>
      <td>(4800,)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>longitude</td>
      <td>degrees_east</td>
      <td>(9600,)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>time</td>
      <td>days since 1999-01-01</td>
      <td>(1,)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BIO01</td>
      <td>K</td>
      <td>(1, 4800, 9600)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seen_variables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># Loop through all NetCDF files to extract information about variables</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">nc_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nc_files</span><span class="p">):</span>
    <span class="n">variable_name</span> <span class="o">=</span> <span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]</span>
    
    <span class="c1"># Skip already processed variables</span>
    <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="n">seen_variables</span><span class="p">:</span>
        <span class="k">continue</span>
    
    <span class="c1"># Open the NetCDF file in read mode</span>
    <span class="k">with</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
        <span class="c1"># Access the primary variable data</span>
        <span class="n">variable_data</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="p">[</span><span class="n">variable_name</span><span class="p">]</span>
        
        <span class="c1"># Generate a summary of the primary variable</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Variable Name&quot;</span><span class="p">:</span> <span class="n">variable_name</span><span class="p">,</span>
            <span class="s2">&quot;Data Type&quot;</span><span class="p">:</span> <span class="n">variable_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
            <span class="s2">&quot;Shape&quot;</span><span class="p">:</span> <span class="n">variable_data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
            <span class="s2">&quot;Variable Info (Dimensions)&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_data</span><span class="o">.</span><span class="n">dimensions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Units&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">variable_data</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Long Name&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">variable_data</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        
        <span class="c1"># Display dataset summary as a DataFrame for better visualization</span>
        <span class="n">nc_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">summary</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="s1">&#39;Remarks&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">. Summary of Variable &#39;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">nc_summary</span><span class="p">)</span>
    
    <span class="c1"># Add the variable name to the seen set</span>
    <span class="n">seen_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span>
    
    <span class="c1"># Limit output</span>
    <span class="n">output_limit</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seen_variables</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">output_limit</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.... (Output truncated to first </span><span class="si">{</span><span class="n">output_limit</span><span class="si">}</span><span class="s2"> variables)&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1. Summary of Variable &#39;BIO01&#39;:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Variable Name</td>
      <td>BIO01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Data Type</td>
      <td>float32</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shape</td>
      <td>(1, 4800, 9600)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Variable Info (Dimensions)</td>
      <td>('time', 'latitude', 'long...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Units</td>
      <td>K</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Long Name</td>
      <td>Temperature annual mean</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5. Summary of Variable &#39;BIO02&#39;:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Variable Name</td>
      <td>BIO02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Data Type</td>
      <td>float32</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shape</td>
      <td>(1, 4800, 9600)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Variable Info (Dimensions)</td>
      <td>('time', 'latitude', 'long...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Units</td>
      <td>K</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Long Name</td>
      <td>Mean diurnal range (mean o...</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.... (Output truncated to first 2 variables)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="export-dataset-to-csv">
<h2>4. Export Dataset to CSV<a class="headerlink" href="#export-dataset-to-csv" title="Link to this heading"></a></h2>
<p>⚠️ <span style="background-color: red; color: white; padding: 2px 4px;">Important</span>: After downloading the datasets, please ensure to select the correct variable name from the appropriate variable group. For example, if you’re interested in the annual mean temperature, choose the variable <strong>BIO01</strong> which is equivalent to <strong>Annual mean temperature (BIO01)</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modify the selected variable here</span>
<span class="n">selected_variable</span> <span class="o">=</span> <span class="s2">&quot;BIO01&quot;</span> <span class="c1"># Set the variable of interest (e.g., BIO01 for Annual Mean Temperature)</span>

<span class="c1"># Filter the NetCDF files based on the selected variable</span>
<span class="n">selected_nc_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">nc_file</span> <span class="k">for</span> <span class="n">nc_file</span> <span class="ow">in</span> <span class="n">nc_files</span> <span class="k">if</span> <span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;ds_variable&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">selected_variable</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="define-a-function-to-convert-netcdf-data-to-a-pandas-dataframe">
<h3>4.1 Define a function to convert NetCDF data to a pandas DataFrame<a class="headerlink" href="#define-a-function-to-convert-netcdf-data-to-a-pandas-dataframe" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="c1"># Function to convert NetCDF data to a pandas DataFrame</span>
<span class="k">def</span><span class="w"> </span><span class="nf">netcdf_to_dataframe</span><span class="p">(</span><span class="n">nc_file</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the variable data from a NetCDF file to a pandas DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        nc_file (dict): A dictionary containing metadata for the NetCDF file, including &#39;path&#39; and &#39;variable_name&#39;.</span>
<span class="sd">        bounding_box (tuple, optional): A tuple of the form (min_lon, min_lat, max_lon, max_lat) to filter the data by geographic bounds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A pandas DataFrame with the filtered data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
        <span class="c1"># Access the variable data from the datase</span>
        <span class="n">variable_data</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="p">[</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]]</span>
        
        <span class="c1"># Ensure latitude and longitude names are correct</span>
        <span class="n">latitude_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span> <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">coords</span> <span class="k">else</span> <span class="s1">&#39;lat&#39;</span>
        <span class="n">longitude_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span> <span class="k">if</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">coords</span> <span class="k">else</span> <span class="s1">&#39;lon&#39;</span>
        
        <span class="c1"># Filter the data based on the bounding box, if provided</span>
        <span class="k">if</span> <span class="n">bounding_box</span><span class="p">:</span>
            <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">variable_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="p">(</span><span class="n">nc_dataset</span><span class="p">[</span><span class="n">latitude_name</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nc_dataset</span><span class="p">[</span><span class="n">latitude_name</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">nc_dataset</span><span class="p">[</span><span class="n">longitude_name</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nc_dataset</span><span class="p">[</span><span class="n">longitude_name</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">variable_data</span>

        <span class="c1"># Convert the xarray dataset to a pandas DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">latitude_name</span><span class="p">,</span> <span class="n">longitude_name</span><span class="p">])</span>
        
        <span class="c1"># Rename the value column to use the filename as the column name (optional)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]:</span> <span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filter-by-bounding-box-create-dataframe-and-export-as-merged-csv-file">
<h3>4.2 Filter by Bounding Box, Create DataFrame and Export as merged CSV file<a class="headerlink" href="#filter-by-bounding-box-create-dataframe-and-export-as-merged-csv-file" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define additional request fields to ensure the request stays within the file size limit.</span>
<span class="c1"># These coordinates were obtained using the BBox Extractor tool:</span>
<span class="c1"># https://str-ucture.github.io/bbox-extractor/</span>

<span class="c1"># Bounding Box for Konstanz (in WGS84 coordinate system: [North, West, South, East])</span>
<span class="n">bbox_wgs84_konstanz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">47.9</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">47.6</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">]</span>

<span class="c1"># Bounding Box for Konstanz (in standard format: [West, South, East, North])</span>
<span class="n">bbox_wgs84_konstanz_standard</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.9</span><span class="p">,</span> <span class="mf">47.6</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">47.9</span><span class="p">]</span>

<span class="c1"># Bounding Box for Germany (in standard format: [West, South, East, North])</span>
<span class="n">bbox_wgs84_de_standard</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.7</span><span class="p">,</span> <span class="mf">47.1</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">,</span> <span class="mf">55.2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>

<span class="c1"># Create a folder for the subset CSV files based on the variable group</span>
<span class="n">subset_csv_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">csv_folder</span><span class="p">,</span> <span class="n">variable_group</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">subset_csv_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define the path for the subset CSV file</span>
<span class="n">subset_csv_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_variable</span><span class="si">}</span><span class="s2">.csv.zip&quot;</span>
<span class="n">subset_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subset_csv_folder</span><span class="p">,</span> <span class="n">subset_csv_filename</span><span class="p">)</span>

<span class="c1"># Create a DataFrame and create a CSV file if it doesn&#39;t already exists</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">subset_csv_path</span><span class="p">):</span>
    <span class="c1"># Process NetCDF files into dataframes and merge them</span>
    <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">netcdf_to_dataframe</span><span class="p">(</span><span class="n">nc_file</span><span class="o">=</span><span class="n">nc_file</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="n">bbox_wgs84_de_standard</span><span class="p">)</span> <span class="k">for</span> <span class="n">nc_file</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">selected_nc_files</span><span class="p">)]</span>
    <span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Export the merged dataframe to a compressed CSV file</span>
    <span class="n">df_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">subset_csv_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File already exists at </span><span class="si">{</span><span class="n">subset_csv_path</span><span class="si">}</span><span class="s2">. Skipping export.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reading existing CSV file...&quot;</span><span class="p">)</span>

    <span class="c1"># Read the existing CSV file into a DataFrame</span>
    <span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">subset_csv_path</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>

<span class="c1"># Function to wrap long column names in the DataFrame for better readability</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wrap_column_names</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
    <span class="n">wrapped_columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">wrapped_columns</span><span class="p">)</span>
    
<span class="c1"># Modify pandas display options to format floats</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
    
<span class="c1"># Display the DataFrame</span>
<span class="n">df_wrapped</span> <span class="o">=</span> <span class="n">wrap_column_names</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">df_wrapped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File already exists at .\data\sis-biodiversity-era5-regional\csv\bioclimatic_indicators_as_in_worldclim\BIO01.csv.zip. Skipping export.
Reading existing CSV file...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>BIO01_era5- to-1km_1979- 2018- mean_v1.0.nc</th>
      <th>BIO01_era5- to-1km_1979- 2018- median_v1.0. nc</th>
      <th>BIO01_era5- to-1km_1979- 2018- q25_v1.0.nc</th>
      <th>BIO01_era5- to-1km_1979- 2018- q75_v1.0.nc</th>
    </tr>
    <tr>
      <th>time</th>
      <th>latitude</th>
      <th>longitude</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="11" valign="top">1999-01-01</th>
      <th rowspan="5" valign="top">47.10</th>
      <th>5.70</th>
      <td>284.57</td>
      <td>284.59</td>
      <td>284.02</td>
      <td>285.10</td>
    </tr>
    <tr>
      <th>5.71</th>
      <td>284.57</td>
      <td>284.59</td>
      <td>284.02</td>
      <td>285.10</td>
    </tr>
    <tr>
      <th>5.72</th>
      <td>284.55</td>
      <td>284.57</td>
      <td>284.00</td>
      <td>285.08</td>
    </tr>
    <tr>
      <th>5.73</th>
      <td>284.54</td>
      <td>284.57</td>
      <td>283.99</td>
      <td>285.07</td>
    </tr>
    <tr>
      <th>5.74</th>
      <td>284.51</td>
      <td>284.54</td>
      <td>283.97</td>
      <td>285.05</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">55.20</th>
      <th>15.16</th>
      <td>281.95</td>
      <td>282.07</td>
      <td>281.51</td>
      <td>282.72</td>
    </tr>
    <tr>
      <th>15.17</th>
      <td>281.94</td>
      <td>282.07</td>
      <td>281.51</td>
      <td>282.71</td>
    </tr>
    <tr>
      <th>15.18</th>
      <td>281.93</td>
      <td>282.06</td>
      <td>281.50</td>
      <td>282.70</td>
    </tr>
    <tr>
      <th>15.19</th>
      <td>281.93</td>
      <td>282.05</td>
      <td>281.49</td>
      <td>282.70</td>
    </tr>
    <tr>
      <th>15.20</th>
      <td>281.92</td>
      <td>282.05</td>
      <td>281.49</td>
      <td>282.69</td>
    </tr>
  </tbody>
</table>
<p>1108080 rows × 4 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="export-dataset-to-geotiff">
<h2>5. Export Dataset to GeoTIFF<a class="headerlink" href="#export-dataset-to-geotiff" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rasterio.transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_origin</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rasterio</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main_export_geotiff</span><span class="p">(</span>
    <span class="n">nc_file</span><span class="p">,</span>
    <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">merged</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Export the entire multi-year dataset or a specified range as a single merged GeoTIFF file.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        nc_file (dict): A dictionary with keys &#39;path&#39; (file path), &#39;variable&#39;, &#39;rcp&#39;, and &#39;statistic&#39;.</span>
<span class="sd">        bounding_box (list): [lon_min, lat_min, lon_max, lat_max] (optional).</span>
<span class="sd">        start_year (int): Starting year for the dataset (optional).</span>
<span class="sd">        end_year (int): Ending year for the dataset (optional).</span>
<span class="sd">        merged (bool): Whether to generate merged GeoTIFF or individual GeoTIFFs (optional).</span>
<span class="sd">        output_directory (str): Directory to save the output GeoTIFF files (optional).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Open the netCDF file</span>
    <span class="k">with</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_dataset</span><span class="p">:</span>
        <span class="n">nc_dataset</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        
        <span class="n">lon</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:]</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
        
        <span class="c1"># Filter by bounding box if provided</span>
        <span class="k">if</span> <span class="n">bounding_box</span><span class="p">:</span>
            <span class="n">lon_min</span><span class="p">,</span> <span class="n">lat_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">,</span> <span class="n">lat_max</span> <span class="o">=</span> <span class="n">bounding_box</span>
            
            <span class="n">indices_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">lat</span> <span class="o">&gt;=</span> <span class="n">lat_min</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&lt;=</span> <span class="n">lat_max</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">indices_lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">lon</span> <span class="o">&gt;=</span> <span class="n">lon_min</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lon</span> <span class="o">&lt;=</span> <span class="n">lon_max</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">start_lat</span><span class="p">,</span> <span class="n">end_lat</span> <span class="o">=</span> <span class="n">indices_lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices_lat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">start_lon</span><span class="p">,</span> <span class="n">end_lon</span> <span class="o">=</span> <span class="n">indices_lon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices_lon</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start_lat</span><span class="p">,</span> <span class="n">end_lat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
            <span class="n">start_lon</span><span class="p">,</span> <span class="n">end_lon</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
        
        <span class="n">lat</span> <span class="o">=</span> <span class="n">lat</span><span class="p">[</span><span class="n">start_lat</span><span class="p">:</span><span class="n">end_lat</span><span class="p">]</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span><span class="p">[</span><span class="n">start_lon</span><span class="p">:</span><span class="n">end_lon</span><span class="p">]</span>
            
        <span class="c1"># Extract time variable and convert it to readable dates</span>
        <span class="n">time_var</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
        <span class="n">time_units</span> <span class="o">=</span> <span class="n">time_var</span><span class="o">.</span><span class="n">units</span>
        <span class="n">time_calendar</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">time_var</span><span class="p">,</span> <span class="s2">&quot;calendar&quot;</span><span class="p">,</span> <span class="s2">&quot;standard&quot;</span><span class="p">)</span>
        <span class="n">cftime</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">time_var</span><span class="p">[:],</span> <span class="n">units</span><span class="o">=</span><span class="n">time_units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="n">time_calendar</span><span class="p">)</span>
        
        <span class="c1"># Compute spatial resolution and raster transformation</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="n">from_origin</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">lat</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="n">dy</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">)</span>
            
        <span class="c1"># Determine the time range</span>
        <span class="n">min_year</span> <span class="o">=</span> <span class="n">cftime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span>
        <span class="n">max_year</span> <span class="o">=</span> <span class="n">cftime</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span>

        <span class="k">if</span> <span class="n">start_year</span> <span class="ow">and</span> <span class="n">end_year</span><span class="p">:</span>
            <span class="c1"># Adjust start_year and end_year based on the available cftime range</span>
            <span class="k">if</span> <span class="n">start_year</span> <span class="o">&lt;</span> <span class="n">min_year</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Provided start year </span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2"> is earlier than the dataset range. Adjusting start year to </span><span class="si">{</span><span class="n">min_year</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">end_year</span> <span class="o">&gt;</span> <span class="n">max_year</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Provided end year </span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s2"> is later than the dataset range. Adjusting end year to </span><span class="si">{</span><span class="n">max_year</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">start_year</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">min_year</span><span class="p">)</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end_year</span><span class="p">,</span> <span class="n">max_year</span><span class="p">)</span>

            <span class="n">dt_full_start</span> <span class="o">=</span> <span class="n">start_year</span>
            <span class="n">dt_full_end</span> <span class="o">=</span> <span class="n">end_year</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Default to the full dataset</span>
            <span class="n">dt_full_start</span> <span class="o">=</span> <span class="n">min_year</span>
            <span class="n">dt_full_end</span> <span class="o">=</span> <span class="n">max_year</span>
            <span class="n">start_year</span> <span class="o">=</span> <span class="n">min_year</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="n">max_year</span>
            
        <span class="c1"># Find indices corresponding to the specified year range</span>
        <span class="n">start_index</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cftime</span><span class="p">)</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">start_year</span><span class="p">)</span>
        <span class="n">end_index</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cftime</span><span class="p">)</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">end_year</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># Year</span>
        
        <span class="c1"># Extract temperature/variable data</span>
        <span class="n">variable_data</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]]</span>
        <span class="n">variable_data_subset</span> <span class="o">=</span> <span class="n">variable_data</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">,</span>
                                            <span class="n">start_lat</span><span class="p">:</span><span class="n">end_lat</span><span class="p">,</span>
                                            <span class="n">start_lon</span><span class="p">:</span><span class="n">end_lon</span><span class="p">]</span>
        
        <span class="c1"># Create subset directory name based on the nc_file</span>
        <span class="n">nc_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nc_files</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-subset.csv.zip&quot;</span>

        <span class="k">if</span> <span class="n">merged</span><span class="p">:</span>
            <span class="c1"># Create a merged GeoTIFF containing all time slices as separate bands</span>
            <span class="k">if</span> <span class="n">output_directory</span><span class="p">:</span>
                <span class="n">subset_directory_path</span> <span class="o">=</span> <span class="n">output_directory</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subset_directory_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">geotiff_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_variable</span><span class="si">}</span><span class="s2">-merged&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">subset_directory_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">output_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.tif&quot;</span>
            <span class="n">output_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subset_directory_path</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">)</span>

            <span class="c1"># Create a GeoTIFF with multiple bands for each time slice</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                <span class="n">output_filepath</span><span class="p">,</span>
                <span class="s2">&quot;w&quot;</span><span class="p">,</span>
                <span class="n">driver</span> <span class="o">=</span> <span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
                <span class="n">nodata</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>        
            <span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">year_index</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                    <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Exporting merged GeoTIFF file from </span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>
                    <span class="n">band_data</span> <span class="o">=</span> <span class="n">variable_data_subset</span><span class="p">[</span><span class="n">year_index</span><span class="p">,:,:]</span>
                    <span class="n">dt</span> <span class="o">=</span> <span class="n">cftime</span><span class="p">[</span><span class="n">start_index</span> <span class="o">+</span> <span class="n">year_index</span><span class="p">]</span>
                    <span class="n">band_desc</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
                    
                    <span class="c1"># Write each year slice as a band</span>
                    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">band_data</span><span class="p">,</span> <span class="n">year_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="n">year_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">band_desc</span><span class="p">)</span>
                    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output_directory</span><span class="p">:</span>
                <span class="n">subset_directory_path</span> <span class="o">=</span> <span class="n">output_directory</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subset_directory_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">geotiff_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selected_variable</span><span class="si">}</span><span class="s2">-individual&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">subset_directory_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">year_index</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Exporting individual GeoTIFF files&quot;</span><span class="p">):</span>
                <span class="c1"># Retrieve the date for the current time slice</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="n">cftime</span><span class="p">[</span><span class="n">start_index</span> <span class="o">+</span> <span class="n">year_index</span><span class="p">]</span>
                <span class="n">dt_full</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="c1"># Define the output GeoTIFF file path            </span>
                <span class="n">output_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nc_filename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">dt_full</span><span class="si">}</span><span class="s2">.tif&quot;</span>
                <span class="n">output_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subset_directory_path</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">)</span>

                <span class="c1"># Export the current time slice as a GeoTIFF</span>
                <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
                    <span class="n">output_filepath</span><span class="p">,</span>
                    <span class="s2">&quot;w&quot;</span><span class="p">,</span>
                    <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GTiff&quot;</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">height</span><span class="o">=</span><span class="n">variable_data_subset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
                    <span class="n">nodata</span><span class="o">=-</span><span class="mi">9999</span><span class="p">,</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
                    <span class="n">year_precipitation_data</span> <span class="o">=</span> <span class="n">variable_data_subset</span><span class="p">[</span><span class="n">year_index</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
                    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">year_precipitation_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">dst</span><span class="o">.</span><span class="n">set_band_description</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the year range to filter and combine data into a single GeoTIFF.</span>
<span class="c1"># If no range is provided, the full dataset will be used.</span>
<span class="c1"># If same start and end year is used for export, then old GeoTIFF file will be replaced.</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Export all merged for Germany</span>
    <span class="k">for</span> <span class="n">nc_file</span> <span class="ow">in</span> <span class="n">selected_nc_files</span><span class="p">:</span>
        <span class="n">main_export_geotiff</span><span class="p">(</span><span class="n">nc_file</span><span class="o">=</span><span class="n">nc_file</span><span class="p">,</span>
                            <span class="n">bounding_box</span><span class="o">=</span><span class="n">bbox_wgs84_de_standard</span><span class="p">,</span>
                            <span class="n">merged</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Merged GeoTIFF</span>
    <span class="c1"># # Export all merged for Konstanz</span>
    <span class="c1"># for nc_file in selected_nc_files:</span>
    <span class="c1">#     main_export_geotiff(nc_file=nc_file,</span>
    <span class="c1">#                         bounding_box=bbox_wgs84_konstanz_standard,</span>
    <span class="c1">#                         merged=True) # Merged GeoTIFF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "74f2ea4967d84297a06180bf5b15fc6a"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "477feeb63896465fb1d7f295a3cdd336"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c9d7452720334f5a909e7419bba6cb51"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "96cd85d9bbd84e1e9e3694c5fdf587c7"}</script></div>
</div>
</section>
<section id="plot-using-matplotlib">
<h2>6. Plot using Matplotlib<a class="headerlink" href="#plot-using-matplotlib" title="Link to this heading"></a></h2>
<section id="plot-the-complete-data">
<h3>6.1 Plot the Complete data<a class="headerlink" href="#plot-the-complete-data" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">netCDF4</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nc</span>

<span class="c1"># Variables and inputs</span>
<span class="n">nc_file</span> <span class="o">=</span> <span class="n">selected_nc_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bounding_box</span> <span class="o">=</span> <span class="n">bbox_wgs84_de_standard</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main_plt_plot</span><span class="p">(</span><span class="n">nc_file</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Open the NetCDF dataset</span>
    <span class="n">nc_dataset</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="c1"># Access latitude and longitude variables</span>
    <span class="n">latitudes</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
    <span class="n">longitudes</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:]</span>

    <span class="c1"># Find indices for the bounding box</span>
    <span class="n">lat_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">latitudes</span> <span class="o">&gt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">latitudes</span> <span class="o">&lt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">3</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lon_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">longitudes</span> <span class="o">&gt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">longitudes</span> <span class="o">&lt;=</span> <span class="n">bounding_box</span><span class="p">[</span><span class="mi">2</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Subset latitude and longitude</span>
    <span class="n">lat_subset</span> <span class="o">=</span> <span class="n">latitudes</span><span class="p">[</span><span class="n">lat_indices</span><span class="p">]</span>
    <span class="n">lon_subset</span> <span class="o">=</span> <span class="n">longitudes</span><span class="p">[</span><span class="n">lon_indices</span><span class="p">]</span>

    <span class="c1"># Extract variable data</span>
    <span class="n">variable_name</span> <span class="o">=</span> <span class="n">nc_file</span><span class="p">[</span><span class="s1">&#39;variable_name&#39;</span><span class="p">]</span>
    <span class="n">variable_data</span> <span class="o">=</span> <span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">][</span><span class="o">...</span><span class="p">,</span> <span class="n">lat_indices</span><span class="p">,</span> <span class="n">lon_indices</span><span class="p">]</span>
    
    <span class="n">var_longname</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">],</span> <span class="s2">&quot;long_name&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
    <span class="n">var_units</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">nc_dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">],</span> <span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate vmin, vmax, and bins</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">variable_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span><span class="p">)</span> <span class="o">*</span> <span class="n">interval</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">variable_data</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span><span class="p">)</span> <span class="o">*</span> <span class="n">interval</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">interval</span><span class="p">)</span>

    <span class="c1"># Create a 2D grid for plotting</span>
    <span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon_subset</span><span class="p">,</span> <span class="n">lat_subset</span><span class="p">)</span>

    <span class="c1"># Create the plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#f1f1f1&#39;</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
    <span class="p">)</span>

    <span class="c1"># Add map features</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Create a colormesh plot</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">pcm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
        <span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">,</span> <span class="n">variable_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
    <span class="p">)</span>

    <span class="c1"># Adjust map extent to match data</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lon_subset</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">lon_subset</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">lat_subset</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">lat_subset</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="c1"># Add a colorbar</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">bins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pcm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_longname</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">var_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
    <span class="c1"># Add grid lines</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
    
    <span class="c1"># Add title and labels</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

    <span class="c1"># Add a title</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_longname</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Save or display the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="c1"># Show the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Example usage</span>
    <span class="n">main_plt_plot</span><span class="p">(</span><span class="n">nc_file</span><span class="o">=</span><span class="n">selected_nc_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounding_box</span><span class="o">=</span><span class="n">bbox_wgs84_de_standard</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9bc25d7f6919a3cd0a46fe9bf6b996a9ccc34793103abaf3864dcae09d2218a7.png" src="../../_images/9bc25d7f6919a3cd0a46fe9bf6b996a9ccc34793103abaf3864dcae09d2218a7.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="04_climate-indicators.html" class="btn btn-neutral float-left" title="Climate Indicators for Europe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="06_era5_land_hourly.html" class="btn btn-neutral float-right" title="ERA5-Land Hourly Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, str.ucture GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>